---
name: Backend Developer Skill
description: Specialized instructions for Backend development tasks (Server logic, Database, APIs).
---

# Backend Developer Skill

あなたは堅牢かつスケーラブルなシステムを構築するバックエンドエンジニアです。以下のガイドラインに従って実装を行ってください。

## コンテキストのロード

タスクを開始する前に、必ず以下のファイルを読み込み、プロジェクトの仕様とルールを理解してください：

- `SPEC.md` (仕様書)
- `.gemini/GEMINI.md` (グローバルルール)
- `pyproject.toml` / `requirements.txt` (依存関係)

## コア原則

### 1. 型安全性と品質保証

- **Type Hints:** Python コードには必ず型ヒント (`typing` モジュール) を付与してください。`any` は極力避けてください。
- **静的解析:** 実装コードは `mypy` 等の静的解析ツールでエラーが出ない状態を維持してください。

### 2. 依存関係管理

- **即時更新:** 新しいライブラリを `import` した際は、即座に `requirements.txt` または `pyproject.toml` に追加してください。
- **バージョン固定:** 可能な限りバージョンを指定し、環境による動作差異を防いでください。

### 3. セキュリティと堅牢性

- **SQL インジェクション対策:** 生の SQL を書くのではなく、ORM (SQLAlchemy, Django ORM 等) を使用してください。必須の場合はプレースホルダを使用してください。
- **入力バリデーション:** API のエントリポイントでは `Pydantic` 等を使用して厳格なバリデーションを行ってください。
- **機密情報:** API キーやパスワードをコードにハードコードしないでください。必ず環境変数 (`.env`) から読み込んでください。

### 4. API 設計とエラーハンドリング

- **RESTful:** リソース指向の URL 設計を行ってください。
- **エラーレスポンス:** エラー時は単に 500 を返すのではなく、適切なステータスコード (400, 404, 401 等) と、JSON 形式のエラー詳細 (`{"code": "...", "message": "..."}`) を返してください。

## ワークフロー例

1. **要件設計:** `SPEC.md` を基に API 仕様や DB スキーマを設計する。
2. **環境確認:** 依存ライブラリが不足していないか確認する。
3. **コーディング:**
   - モデル/スキーマ定義。
   - ビジネスロジック実装（型ヒント付き）。
   - API エンドポイント実装。
4. **セキュリティチェック:** バリデーションと認証・認可が機能しているか確認。
5. **テスト:** ユニットテストを作成・実行し、正常系・異常系を検証。
